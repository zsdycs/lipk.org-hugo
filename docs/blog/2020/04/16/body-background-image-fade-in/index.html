<!DOCTYPE html>
<html lang="zh-cn">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <title>执手对影成双 - Body，你的背景图片怎么淡入哇？</title>
  
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-154705931-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-154705931-1');
  </script>

  <meta property="og:title" content="执手对影成双 | pengkun Lee">
  <meta property="og:type" content="website">
  <meta name="keywords" content="个人网站,博客">
  <meta name="baidu-site-verification" content="DjOoDNzsC0">
  <script>
    console.info(
      "%c自主%c、%c跨界%c、%c终身学习%c。",
      "color:#E24432; font-size: 16px;","color:#666666; font-size: 16px;",
      "color:#0E70ED; font-size: 16px;","color:#666666; font-size: 16px;",
      "color:#009E5E; font-size: 16px;","color:#666666; font-size: 16px;");
  </script>
  
  
  

  
  
  <meta property="description" content="今天偶然看到本站在加载页面时的一个问题。
由于本站默认是夜间模式，夜间模式是通过 CSS 的 mix-blend-mode: difference 实现的，模式切换通过异步载入的 js 控制。
这就导致背景图片（白色）加载完成后切换到夜间模式会发生闪烁，这违背了黑夜模式的初衷。
[&amp;hellip;] 对于背景图片的淡入，网上有很多种解决方法。 有说用 animation &#43; opacity 的。像 &amp;hellip;">
  <meta property="og:description" content="今天偶然看到本站在加载页面时的一个问题。
由于本站默认是夜间模式，夜间模式是通过 CSS 的 mix-blend-mode: difference 实现的，模式切换通过异步载入的 js 控制。
这就导致背景图片（白色）加载完成后切换到夜间模式会发生闪烁，这违背了黑夜模式的初衷。
[&amp;hellip;] 对于背景图片的淡入，网上有很多种解决方法。 有说用 animation &#43; opacity 的。像 &amp;hellip;">
  
  

  
  


<link
    href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/styles/Vs%202015.min.css'
    rel='stylesheet' type='text/css' />



  <link rel="icon" type="image/x-icon" href="/zsdycs_favicon.ico">
  <link rel="stylesheet" href="/css/style.css" />
  <link rel="stylesheet" href="/css/fonts.css" />
  <script async src="/js/load-typekit.js"></script>
<script src="/js/darkmode-js.min.js"></script>
<script src="/js/get-url-relative-path.js"></script>
<link rel="stylesheet" href="/css/custom.css" />
<link rel="stylesheet" href="/css/loading.css" />
</head>



<body class="blog">
  <div class="paramount">
  <header class="masthead">
    <h1>
  <img src="/images/logo.png" alt="执手对影成双" />
</h1>


    <nav class="menu">
  <ul>
    
    
    <li><a href="/">返回</a></li>
      
    <li><a href="/blog/">博客</a></li>
      
    <li><a href="/food/">美食</a></li>
      
      




<li><a href="http://github.com/zsdycs/zsdycs.cn/edit/master/content/blog/2020-04-16-Dody-background-image-fade-in.md" title="编辑本页"
    target="_blank">
    编辑
  </a></li>
<li><a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" title="版权声明" target="_blank">
    版权
  </a></li>



  </ul>
</nav>

  </header>

  <article class="main">
    <header class="title">
      
<h1>Body，你的背景图片怎么淡入哇？</h1>

<h3>
     
    李鹏坤 / 2020-04-16
</h3>
<hr>


    </header>
    


<h2 id="缘由">缘由</h2>
<p>今天偶然看到本站在加载页面时的一个问题。</p>
<p>由于本站默认是夜间模式，夜间模式是通过 CSS 的 <code>mix-blend-mode: difference</code> 实现的，模式切换通过异步载入的 js 控制。</p>
<p>这就导致背景图片（白色）加载完成后切换到夜间模式会发生闪烁，这违背了黑夜模式的初衷。</p>
<h2 id="过程">过程</h2>
<p>对于背景图片的淡入，网上有很多种解决方法。
有说用 <code>animation</code> + <code>opacity</code> 的。像这样写:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-CSS" data-lang="CSS">#background-div {
    <span style="color:#75715e">/* 加载自定义的 bgFadeIn 动画 */</span>
    <span style="color:#66d9ef">animation</span>: bgFadeIn <span style="color:#ae81ff">3</span><span style="color:#66d9ef">s</span> <span style="color:#66d9ef">ease</span><span style="color:#f92672">-</span>in;
}

@<span style="color:#66d9ef">-webkit-keyframes</span> <span style="color:#f92672">fadeIn</span> {
    <span style="color:#f92672">0</span><span style="color:#f92672">%</span> {
    <span style="color:#75715e">/* opacity 属性初始值 */</span>
        <span style="color:#66d9ef">opacity</span>: <span style="color:#ae81ff">0</span>;
    }
    <span style="color:#f92672">100</span><span style="color:#f92672">%</span> {
    <span style="color:#75715e">/* 动画完成后 opacity 的值 */</span>
        <span style="color:#66d9ef">opacity</span>: <span style="color:#ae81ff">1</span>;
    }
}
</code></pre></div><p>也有说用使用 <code>transition</code> + <code>opacity</code> 实现的。也就是这样写:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-CSS" data-lang="CSS">#background-div {
    <span style="color:#75715e">/* opacity 属性初始值 */</span>
    <span style="color:#66d9ef">opacity</span>: <span style="color:#ae81ff">0</span>;
    <span style="color:#75715e">/* transition 控制 opacity 属性 */</span>
    <span style="color:#66d9ef">transition</span>: <span style="color:#66d9ef">opacity</span> <span style="color:#ae81ff">3</span><span style="color:#66d9ef">s</span> <span style="color:#66d9ef">ease</span><span style="color:#f92672">-</span>in;
}

#background-div:<span style="color:#a6e22e">hover</span> {
    <span style="color:#66d9ef">opacity</span>: <span style="color:#ae81ff">1</span>;
}
</code></pre></div><p>我用了都没有用。为什么呢？我发现这些都是在控制元素本身，并不能控制元素的 <code>background</code>，也就是元素的属性。
这种情况下，唯有 JS。
于是，我决定放弃搜索。思考了一下，只要在页面加载时，黑夜白天模式<del>切换</del>加载完成后，对背景进行设置其实就可以解决问题。</p>
<h2 id="解决">解决</h2>
<p>也就是这样:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// 黑夜白天模式载入
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">darkmode</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Darkmode</span>(<span style="color:#a6e22e">options</span>);
<span style="color:#a6e22e">darkmode</span>.<span style="color:#a6e22e">showWidget</span>();

<span style="color:#75715e">// body 背景 延迟载入
</span><span style="color:#75715e"></span>document.<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">style</span>.<span style="color:#a6e22e">background</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;url(/images/your-background-image.png)&#39;</span>;
document.<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">style</span>.<span style="color:#a6e22e">backgroundRepeat</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;repeat&#39;</span>;
</code></pre></div><p>这个故事告诉我们，很多时候，解决问题的方法不是我们刚开始想象的那样。
也就是可能一开始<del>的方向可能就是错的</del>问题都没弄清。要变通，虽然一条路是可以走到黑，但是换个角度思考问题，一定是解决问题的正确方法。</p>
<h4 id="版权声明httpszsdycssirvcomzsdycscncreativecommons-ccsvghttpscreativecommonsorglicensesby-nc-nd40"><a href="https://creativecommons.org/licenses/by-nc-nd/4.0/"><img src="https://zsdycs.sirv.com/zsdycs.cn/creativecommons-cc.svg" alt="版权声明"></a></h4>

<footer>
  
<nav class="post-nav">
  <span class="nav-prev">&larr; <a href="/blog/2020/04/15/goodbye-19003986/" title="你可以使用方向键">再见 19003986</a></span>
  <span class="nav-next"><a href="/blog/2020/04/21/js-js/" title="你可以使用方向键">JS 啊，JS</a> &rarr;</span>
</nav>
<script type="text/javascript">
document.addEventListener('keyup', function(e) {
  if (e.target.nodeName.toUpperCase() != 'BODY') return;
  var url = false;
  if (e.which == 37) {  
    
    url = '\/blog\/2020\/04\/15\/goodbye-19003986\/';
    
  } else if (e.which == 39) {  
    
    url = '\/blog\/2020\/04\/21\/js-js\/';
    
  }
  if (url) window.location = url;
});
</script>



<section id="utterances" class="comments">
  <div id="loading">
    <div class="container animation-2">
      <div class="shape shape1"></div>
      <div class="shape shape2"></div>
      <div class="shape shape3"></div>
      <div class="shape shape4"></div>
    </div>
  </div>
</section>


<script async src="/js/darkmode.js"></script>

<script async src="/js/utteranc.js"></script>

<script async src="/js/fix-toc.js"></script>

<script async src="/js/math-code.js"></script>

<script async src="/js/center-img.js"></script>

<script async src="/js/right-quote.js"></script>

<script async src="/js/no-highlight.js"></script>

<script async src="/js/fix-footnote.js"></script>

<script async src="/js/external-link.js"></script>

<script async src="/js/alt-title.js"></script>




  
  <hr>
  <div class="copyright" id="add-icp">
    <span id="slogan">执手相看，对影成双</span>
    © <a href="/">执手对影成双</a> 2018 - 2020
  </div>
  
</footer>
</article>
</div>
</body>

</html>
